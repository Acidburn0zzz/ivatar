{% extends 'base.html' %}                                                                                                                      
{% load i18n %}
{% load static %}

{% block title %}{% trans 'Your Preferences' %}{% endblock title %}

{% block content %}
<h1>{% trans 'Account settings' %}</h1>

<h2>{% trans 'Theme' %}</h2>
<p>
  <form method="post" action="{% url 'user_preference' %}">{% csrf_token %}
    <div class="form-group">
      {% for theme in THEMES %}
        <div class="radio">
          <input type="radio" name="theme" value="{{ theme.0 }}"
            id="theme-{{ theme.0 }}"
            {% if user.userpreference.theme == theme.0 %}checked{% endif %}
            {% if THEMES|first == theme %}{% if not user.userpreference.theme %}checked{% endif %}{% endif %}
          >
          <label for="theme-{{ theme.0 }}">{{ theme.1 }}</label>
        </div>
      {% endfor %}
      <br/>
      <button type="submit" class="btn btn-default">{% trans 'Save' %}</button>
    </div>
  </form>
</p>

<!-- TODO: Language stuff not yet fully implemented; Esp. translations are only half-way there

<h2>{% trans 'Language' %}</h2>
<form action="{% url 'set_language' %}" method="post">{% csrf_token %}
      <div class="form-group">
        {% get_current_language as LANGUAGE_CODE %}
        {% get_available_languages as LANGUAGES %}
        {% get_language_info_list for LANGUAGES as languages %}
        {% for language in languages %}
			<div class="radio">
			<input type="radio" name="language" value="{{ language.code }}" id="language-{{ language.code }}" {% if language.code == LANGUAGE_CODE %}checked{% endif %}>
			<label for="language-{{ language.code }}">{{ language.name_local }}</label>
			</div>
        {% endfor %}
      </div>
    <br/>
    <button type="submit" class="btn btn-default">{% trans 'Save' %}</button>
</form>

-->

<h2>{% trans 'API Key' %}</h2>
{% if user.apikey %}
<input type="text" name="api_key" id="api_key" value="{{ user.apikey.api_key }}" style="width:400px; float:left;" class="form-control" readonly>&nbsp;
<button class="btn btn-default" onclick="copyToClipboard()">Copy to clipboard</button>
  <script>
    function copyToClipboard() {
      var copyText = document.getElementById("api_key");
      copyText.select();
      document.execCommand("copy");
    }
  </script>
{% else %}
  <form action="{% url 'generate_api_key' %}" method="post">{% csrf_token %}
    <button type="submit" class="btn btn-default">{% trans 'Generate API key' %}</button>
</form>
{% endif %}

<div style="height:40px"></div>

<!-- <p><a href="{% url 'export' %}" class="btn btn-default">{% trans 'Export your data' %}</a></p> -->

<p><a href="{% url 'delete' %}" class="btn btn-default">{% trans 'Permanently delete your account' %}</a></p>
<div style="height:40px"></div>
{% endblock content %}
